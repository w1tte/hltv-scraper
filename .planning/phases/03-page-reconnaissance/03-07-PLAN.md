---
phase: 03-page-reconnaissance
plan: 07
type: execute
wave: 3
depends_on: ["03-02", "03-03", "03-04", "03-05", "03-06"]
files_modified:
  - .planning/phases/03-page-reconnaissance/recon/edge-cases.md
  - .planning/phases/03-page-reconnaissance/recon/cross-page-summary.md
autonomous: true

must_haves:
  truths:
    - "Cross-page data overlap map exists showing which fields appear on multiple page types"
    - "Canonical extraction source is recommended for each overlapping field"
    - "BO1 vs BO3 vs BO5 structural differences are consolidated from all page type analyses"
    - "Forfeit/walkover impact is documented across all page types"
    - "Overtime handling is consolidated across all page types"
    - "Rating version detection strategy is finalized with a single recommended approach"
  artifacts:
    - path: ".planning/phases/03-page-reconnaissance/recon/cross-page-summary.md"
      provides: "Data overlap map across all 5 page types with canonical source recommendations"
      min_lines: 80
    - path: ".planning/phases/03-page-reconnaissance/recon/edge-cases.md"
      provides: "Consolidated edge case documentation: BO1/BO3/BO5, overtime, forfeits, rating versions"
      min_lines: 100
  key_links:
    - from: "recon/cross-page-summary.md"
      to: "recon/results-listing.md, recon/match-overview.md, recon/map-stats.md, recon/map-performance.md, recon/map-economy.md"
      via: "Field cross-referencing"
      pattern: "overlap|canonical|duplicate"
    - from: "recon/edge-cases.md"
      to: "recon/match-overview.md, recon/map-stats.md, recon/map-performance.md"
      via: "Edge case consolidation"
      pattern: "forfeit|overtime|BO5|rating"
---

<objective>
Synthesize findings from all 5 page-type analyses (plans 03-02 through 03-06) into two summary documents: a cross-page data overlap map and a consolidated edge case reference.

Purpose: These documents provide Phase 4-7 developers with a single place to look up which page to extract a given field from, and how to handle every known edge case.
Output: `recon/cross-page-summary.md` and `recon/edge-cases.md`
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-page-reconnaissance/03-RESEARCH.md
@.planning/phases/03-page-reconnaissance/recon/sample-manifest.md
@.planning/phases/03-page-reconnaissance/recon/results-listing.md
@.planning/phases/03-page-reconnaissance/recon/match-overview.md
@.planning/phases/03-page-reconnaissance/recon/map-stats.md
@.planning/phases/03-page-reconnaissance/recon/map-performance.md
@.planning/phases/03-page-reconnaissance/recon/map-economy.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create cross-page data overlap map</name>
  <files>.planning/phases/03-page-reconnaissance/recon/cross-page-summary.md</files>
  <action>
Read ALL 5 page-type selector map documents from the recon directory. Cross-reference every documented field to identify:

1. **Fields that appear on multiple page types** (overlapping data)
2. **Fields unique to one page type** (exclusive data)
3. **Canonical extraction source** recommendation for each field

**Create the overlap map document with these sections:**

**Section 1: Field Inventory**
A master table listing EVERY data field the scraper will extract, with columns:
- Field name (e.g., "team1_name", "player_kills", "round_equipment_value")
- Page types where this field appears (checkmarks or list)
- Recommended canonical source (which page to extract from)
- Reason for source recommendation (e.g., "more reliable", "richer data", "available earlier in pipeline")

**Section 2: Overlapping Fields Detail**
For each field that appears on 2+ page types:
- List all page types with their CSS selectors for this field
- Note any differences in format, precision, or completeness between pages
- Recommend which page to extract from and why

Common overlapping fields to check:
- Team names (results listing, match overview, map stats, performance, economy)
- Player names (match overview rosters, map stats scoreboard, performance table)
- Map score (match overview half scores, map stats team rounds)
- Rating value (map stats scoreboard, performance table)
- Round outcomes (map stats round history, economy page)

**Section 3: Exclusive Fields**
For each field that appears on only ONE page type:
- Which page type it's exclusive to
- Whether it's critical or optional for the scraper

**Section 4: Data Flow Diagram**
A text-based diagram showing the extraction pipeline:
```
Results listing -> match IDs, teams, scores, dates, events
  |
  v (per match)
Match overview -> format, vetoes, rosters, mapstatsids, half scores
  |
  v (per map, using mapstatsid)
Map stats -> scoreboard (K/D/A/ADR/rating), round history
Map performance -> KPR/DPR, impact/round swing, multi-kills, clutches
Map economy -> equipment values, buy types
```

**Section 5: Extraction Order Recommendation**
Based on the overlap analysis, recommend the optimal order for Phases 4-7:
- Which page types should be parsed first (they provide IDs needed by later parsers)
- Where to avoid duplicate extraction (field X is on both pages A and B, but extract from A only)
  </action>
  <verify>File exists at `.planning/phases/03-page-reconnaissance/recon/cross-page-summary.md`. Contains a master field inventory table. Contains overlap analysis. Contains canonical source recommendations. Contains data flow diagram.</verify>
  <done>Cross-page data overlap map exists with master field inventory, overlap analysis with canonical source recommendations, and data flow diagram showing extraction pipeline</done>
</task>

<task type="auto">
  <name>Task 2: Create consolidated edge case reference</name>
  <files>.planning/phases/03-page-reconnaissance/recon/edge-cases.md</files>
  <action>
Read ALL 5 page-type selector map documents and consolidate all edge case findings into a single reference document.

**Create the edge case document with these sections:**

**Section 1: BO1 vs BO3 vs BO5 Structural Differences**
Consolidate from match overview and map stats analyses:
- Number of map holders / map stats pages
- Veto structure differences (table from match overview analysis)
- Unplayed map representation
- How the parser should handle variable map counts

**Section 2: Overtime Matches**
Consolidate from map stats, performance, and economy analyses:
- Round history DOM structure for overtime (from map stats doc)
- How half scores change with overtime (from match overview doc)
- Whether economy data includes overtime rounds (from economy doc)
- Total round count detection (team1_rounds + team2_rounds > 24)
- Parser handling recommendation: how to iterate rounds when count is variable

**Section 3: Forfeit / Walkover Matches**
Consolidate from match overview analysis:
- Which DOM elements are present vs missing on forfeit pages
- Which page types have NO data for forfeits (map stats, performance, economy)
- Parser handling recommendation: detect early and skip sub-page fetching

**Section 4: Rating Version Handling**
Consolidate from map stats and performance analyses:
- Which pages show rating-version-dependent content
- The finalized detection strategy (from performance page analysis -- refine if needed)
- Impact on database storage (which columns to populate based on version)
- Parser handling recommendation: single detector function used across parsers

**Section 5: Other Edge Cases**
Document any additional edge cases discovered during analysis:
- Showmatches (if sample was fetched)
- Missing player data (substitutes, coaches playing)
- Unusual team sizes (not exactly 5 players)
- Matches with partial data (some stats missing)
- Any CSS class variations observed across eras that could break selectors

**Section 6: Edge Case Detection Cheatsheet**
A quick-reference table for parser developers:

| Edge Case | Detection Method | Parser Action |
|-----------|-----------------|---------------|
| Forfeit | No `.results-stats` links on overview page | Skip map sub-pages |
| Overtime | Total rounds > 24 in map stats | Extend round iteration |
| BO5 | 5 `.mapholder` elements | Iterate up to 5 maps |
| Rating 3.0 | [detection signal from analysis] | Use 3.0 column selectors |
| Showmatch | Event name contains "Showmatch" | Flag in DB, parse normally |
  </action>
  <verify>File exists at `.planning/phases/03-page-reconnaissance/recon/edge-cases.md`. Contains sections for BO1/BO3/BO5, overtime, forfeits, rating versions. Contains detection cheatsheet. All findings are consolidated from the individual page-type docs (not just copied).</verify>
  <done>Consolidated edge case reference exists with BO format differences, overtime handling, forfeit detection, rating version strategy, and quick-reference detection cheatsheet</done>
</task>

</tasks>

<verification>
1. `recon/cross-page-summary.md` exists with master field inventory and overlap analysis (80+ lines)
2. `recon/edge-cases.md` exists with all edge case types consolidated (100+ lines)
3. Cross-page summary has canonical source recommendations for every overlapping field
4. Edge cases doc has detection cheatsheet table
5. Rating version detection strategy is finalized (single recommended approach)
6. Both documents cross-reference the 5 page-type selector maps
</verification>

<success_criteria>
- Cross-page data overlap is fully mapped -- every field has a canonical extraction source
- All edge cases from individual page analyses are consolidated into one reference
- Rating version detection strategy is finalized and actionable
- Edge case detection cheatsheet provides quick lookup for parser developers
- Both documents are useful standalone references for Phases 4-7 without needing to re-read all 5 page-type docs
- RECON-05 (cross-page data overlap) is fully satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/03-page-reconnaissance/03-07-SUMMARY.md`
</output>
