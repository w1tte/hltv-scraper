---
phase: 03-page-reconnaissance
plan: 03
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - .planning/phases/03-page-reconnaissance/recon/match-overview.md
autonomous: true

must_haves:
  truths:
    - "CSS selectors for every data field on the match overview page are documented"
    - "Veto section structure is documented for BO1, BO3, and BO5 formats"
    - "Player roster extraction path (player name, player ID, team attribution) is documented"
    - "Map stats links (mapstatsid extraction from hrefs) are documented"
    - "Half-score breakdown (CT/T side rounds per map) is documented"
    - "Selectors are verified programmatically against multiple saved HTML samples"
  artifacts:
    - path: ".planning/phases/03-page-reconnaissance/recon/match-overview.md"
      provides: "Complete selector map for HLTV /matches/{id}/{slug} pages"
      min_lines: 200
  key_links:
    - from: "recon/match-overview.md"
      to: "data/recon/match-*-overview.html.gz"
      via: "BeautifulSoup .select() verification"
      pattern: "soup\\.select"
---

<objective>
Analyze the HLTV match overview page (`/matches/{match_id}/{slug}`) to produce a complete CSS selector map documenting every extractable data field -- teams, scores, format, event, vetoes, rosters, map links, and half-score breakdowns.

Purpose: This selector map will be consumed directly by Phase 5 (Match Overview Extraction) to build the match overview parser.
Output: `.planning/phases/03-page-reconnaissance/recon/match-overview.md`
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-page-reconnaissance/03-RESEARCH.md
@.planning/phases/03-page-reconnaissance/03-01-SUMMARY.md
@.planning/phases/03-page-reconnaissance/recon/sample-manifest.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Programmatic selector discovery for match overview metadata</name>
  <files>.planning/phases/03-page-reconnaissance/recon/match-overview.md</files>
  <action>
Write a temporary analysis script that loads ALL match overview HTML samples from `data/recon/match-*-overview.html.gz` and systematically discovers and verifies CSS selectors using BeautifulSoup.

**Analysis targets -- verify each selector against ALL match overview samples (BO1, BO3, BO5, overtime, forfeit):**

**Section 1: Match metadata**
- Team 1 name (expected: `.team1-gradient .teamName`)
- Team 2 name (expected: `.team2-gradient .teamName`)
- Team 1 ID (parse from `.team1-gradient a[href]`, pattern `/team/{id}/{slug}`)
- Team 2 ID (parse from `.team2-gradient a[href]`)
- Team 1 ranking (expected: `.teamRanking a`, contains "#N")
- Team 2 ranking
- Winner indicator (expected: `.won` class on winning team's gradient)
- Match date/time (expected: `.timeAndEvent .date[data-unix]`, unix milliseconds)
- Event name (expected: `.timeAndEvent .event a`)
- Event ID (parse from `.timeAndEvent .event a[href]`, pattern `/events/{id}/{slug}`)
- Match format: BO1/BO3/BO5 (expected: `.preformatted-text`, parse for "Best of N")
- LAN/online indicator (expected: in `.preformatted-text`, look for "LAN" or "Online")

**Section 2: Map holders and scores**
- Map holder container (expected: `.mapholder`)
- Map name (expected: `.mapname` inside mapholder)
- Map scores -- left/right (expected: `.results-left .results-team-score`, `.results-right .results-team-score`)
- Half scores (expected: `.results-center-half-score`)
- Which team is "left" vs "right" (is team1 always left?)
- Unplayed maps (BO3 where only 2 maps played -- what does the 3rd mapholder look like?)
- Map stats link (expected: `.results-stats[href]`, extract mapstatsid from `/stats/matches/mapstatsid/{id}/{slug}`)

**Section 3: Veto sequence**
- Veto container (expected: `.veto-box`)
- Individual veto lines -- how are they structured? (expected: `div` children with text like "1. FaZe removed Mirage")
- Team attribution in vetoes (team name appears in text -- parse with regex or separate element?)
- Veto action types: removed/picked/was left over
- Document veto structure differences between BO1, BO3, and BO5

**Section 4: Player rosters**
- Player container (expected: `div.players` -- one per team)
- Player name (expected: `.text-ellipsis` inside player container)
- Player ID (expected: `[data-player-id]` attribute or parse from player link href)
- Player link (href containing `/player/{id}/{name}`)
- Team attribution (which player container maps to which team)
- Player flag/nationality (if present in DOM)

**Section 5: Other elements**
- Head-to-head section (historical matches between these teams)
- Streams section (not needed but document presence)
- Pickup/demo links
- GOTV section
- Any promotional/ad elements to filter out

**For EACH selector:**
- Run `soup.select(selector)` on all samples
- Record: match count per sample, example values, consistency
- If selector fails on any sample, investigate why and document the variation
- Pay special attention to the forfeit/walkover sample -- which elements are MISSING?

**Document ALL visible fields.** Mark each with extraction status:
- **extract**: Phase 5 will parse this
- **skip**: Present but not needed (streams, ads, GOTV)
- **future**: Might extract later (head-to-head, demos)

**Include annotated HTML snippets** for the most important structural patterns:
- Team container structure
- Mapholder structure (including half scores)
- Veto box structure (one snippet per format: BO1, BO3, BO5)
- Player roster structure

**Forfeit/walkover section:**
Dedicate a subsection to documenting what is DIFFERENT on forfeit/walkover match pages vs regular matches. List every element that is missing or modified.
  </action>
  <verify>
The file `.planning/phases/03-page-reconnaissance/recon/match-overview.md` exists and contains:
1. Selector tables for all 5 sections (metadata, maps, vetoes, rosters, other)
2. Annotated HTML snippets for team containers, mapholders, vetoes, rosters
3. Veto structure documented for BO1, BO3, and BO5
4. Forfeit/walkover differences documented
5. Verification notes confirming selectors tested against all samples
6. All fields marked with extraction status
7. Document is 200+ lines
  </verify>
  <done>Complete selector map for match overview page exists, all selectors verified against multiple samples including different formats (BO1/BO3/BO5) and edge cases (forfeit), veto structures documented per format, player roster extraction path documented</done>
</task>

</tasks>

<verification>
1. `.planning/phases/03-page-reconnaissance/recon/match-overview.md` exists and is 200+ lines
2. All 5 sections covered: metadata, map holders, vetoes, rosters, other elements
3. Veto section shows structure for BO1, BO3, and BO5 with annotated HTML
4. Forfeit/walkover differences are explicitly documented
5. mapstatsid extraction from map stats links is documented with regex/parse pattern
6. Every selector tested against multiple samples with verification notes
</verification>

<success_criteria>
- Every extractable field on the match overview page has a documented CSS selector
- Veto structures for BO1, BO3, and BO5 are documented with annotated HTML
- Player roster extraction path fully documented (name, ID, team attribution)
- mapstatsid links documented with extraction pattern
- Forfeit/walkover page differences explicitly listed
- Document is detailed enough for Phase 5 to build a parser without needing to inspect HTML
</success_criteria>

<output>
After completion, create `.planning/phases/03-page-reconnaissance/03-03-SUMMARY.md`
</output>
